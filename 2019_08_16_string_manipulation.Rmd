---
title: "String Manipulation"
output: html_notebook
---

I want to experiment with concatenating strings in R. My main reference for this is the [R4DS strings chapter](https://r4ds.had.co.nz/strings.html#string-basics).

```{r}
library(tidyverse)
library(stringr)
```

```{r}
string1 <- "fee foo fob"
string2 <- "bee boo bob"
```

Pasting them together should be easy:
```{r}
string3 <- str_c(string1, string2)
string3
```

With sequences, I can easily paste in TTT to pad them:
```{r}
seq1 <- "GGGG"
seq2 <- "AAAA"

seq3 <- str_c(seq1, seq2, sep = "TTT")
seq3
```

A nice feature is that str_c() is vectorized:
```{r}
str_c("prefix-", c("a", "b", "c"), "-suffix")
```

It's also possible to collapse a vector of strings. I may want to use this with my concatenations of multiple different Oligopaint components.
```{r}
str_c(c("x", "y", "z"), collapse = ", ")
```

Can I pass named variables into a vector for this?
```{r}
str_c(c(seq1, seq2), collapse = "TTT")
```

How does this work for the column of a data frame?
```{r}
probes <- read_delim("/Users/hershe/Documents/OligoServer/probe_dbs/refseq_hg38_DNA-FISH_DB.csv",
                     col_names = c("chrom", "start", "stop", 
                                   "sequence", "Tm", "on-target",
                                   "off-target", "repeat", "max-kmer",
                                   "refseq"),
                     delim = "\t")
```

I actually want a smaller subset.
```{r}
probes <- head(probes, 100)
probes
```

I want to append a prefix as a test to all sequences:
```{r}
probes %>%
  mutate(sequence = str_c("foo", sequence))
```

This is too straight forward. I want to take all unique refseq IDs and put them into a vector, so that I can iterate over them

```{r}
refseq_ids <- unique(probes$refseq)

for (refseq in refseq_ids) {
  print(refseq)
}
```

I actually want to iterate numerically:

```{r}
for (i in refseq_ids) {
  print(i)
}
```

Now I'll make a list of six strings and paste them onto the unique probes
```{r}
append_strings = c("woo", "wa", "wee", "woo", "foo", "bar")

my_data = list()

for (i in 1:length(refseq_ids)) {
  my_data[[i]] = probes %>%
    filter(refseq == refseq_ids[i]) %>%
    mutate(sequence = str_c(append_strings[i], sequence))
}

appended_df = bind_rows(my_data)
```

The following is a quick test of manipulating the 168.primers file from Brian.
```{r}
primers <- read_tsv("./appending/168.primers.txt", col_names = c("ID",
                                                                 "primer"))

head(primers['primer'])
```












